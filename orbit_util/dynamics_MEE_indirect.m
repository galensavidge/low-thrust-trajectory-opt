function Xdot = dynamics_MEE_indirect(X, mu, g0, Isp, Tmax, rho)
% Evaluates the resulting equations of motion of the modified equinoctial 
% elements after the primer vector based optimal control law has been 
% substituted into the Hamiltonian.

% Orbit state
x = X(1:6);
m = X(7);
px = X(8:13);
pm = X(14);

% Thrust magnitude
T = calc_thrust_MEE_indirect(x, m, px, pm, mu, g0, Isp, Tmax, rho);

% Split up state and adjoint vectors
p = x(1);
f = x(2);
g = x(3);
h = x(4);
k = x(5);
L = x(6);

px1 = px(1);
px2 = px(2);
px3 = px(3);
px4 = px(4);
px5 = px(5);
px6 = px(6);

% Feed into autogenerated equations of motion
xdot = xdot_MEE_autogen(L,T,f,g,h,k,m,mu,p,px1,px2,px3,px4,px5,px6);
mdot = mdot_MEE_autogen(Isp,T,g0);
pxdot = pxdot_MEE_autogen(L,T,f,g,h,k,m,mu,p,px1,px2,px3,px4,px5,px6);
pmdot = pmdot_MEE_autogen(L,T,f,g,h,k,m,mu,p,px1,px2,px3,px4,px5,px6);

% Combine into single state time derivative vector
Xdot = [xdot; mdot; pxdot; pmdot];